# üì° –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å ChirpStack —á–µ—Ä–µ–∑ API (httpChirp)

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —á–µ—Ä–µ–∑ ChirpStack, –∏—Å–ø–æ–ª—å–∑—É—è –≤–µ–±—Ö—É–∫ –∏ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å –ø—Ä–æ–±—Ä–æ—Å–æ–º —á–µ—Ä–µ–∑ **ngrok**.

---

## üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç—ã

1. **–õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–∞ Node.js** —Å–ª—É—à–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –æ—Ç ChirpStack.
2. **ngrok** –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.
3. ChirpStack –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è (uplink, join, ack –∏ —Ç.–¥.) –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π HTTP endpoint.
4. –ü–æ–ª—É—á–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –ª–æ–∫–∞–ª—å–Ω–æ–º soap —Å–µ—Ä–≤–µ—Ä–µ

---

## üöÄ –ó–∞–ø—É—Å–∫

### 1. –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä

```bash
node httpChirp.js
```

–¢—ã —É–≤–∏–¥–∏—à—å:

```
Server is running on port 3000
```

–°–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç **3000** –∏ –æ–∂–∏–¥–∞–µ—Ç POST-–∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `/webhook`.

---

### 2. –ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–∞ —á–µ—Ä–µ–∑ ngrok

–í **–¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ**:

```bash
ngrok http 3000
```

–¢—ã —É–≤–∏–¥–∏—à—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–π –≤—ã–≤–æ–¥:

```
Forwarding    https://d1be-61-245-10-43.ngrok-free.app -> http://localhost:3000
```

–°–æ—Ö—Ä–∞–Ω–∏ –∞–¥—Ä–µ—Å `https://d1be-61-245-10-43.ngrok-free.app` ‚Äî –æ–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–∞–ª–µ–µ.

---

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ChirpStack

1. –ü–µ—Ä–µ–π–¥–∏ –≤ ChirpStack:
   ```
   Applications ‚Üí [–Ω—É–∂–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ] ‚Üí Integrations ‚Üí HTTP
   ```

2. –í –ø–æ–ª–µ **Event Endpoint URL(s)** —É–∫–∞–∂–∏:

```
https://d1be-61-245-10-43.ngrok-free.app/webhook
```
**–î–æ–±–∞–≤–∏—Ç—å `/webhook` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!** 

(–∏–ª–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π URL –æ—Ç ngrok)

3. –°–æ—Ö—Ä–∞–Ω–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

---

## üì• –ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å –≤—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ

–í—Å–µ —Å–æ–±—ã—Ç–∏—è –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω `httpChirp.js`, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```
Received event: {
  eventType: 'up',
  deviceInfo: { devEui: '0700f8ffeece1131', ... },
  data: 'AF12...' // base64
}
```

---

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è soap —Å–µ—Ä–≤–µ—Ä–æ–º

–í **—Ç—Ä–µ—Ç—å–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ**: –∑–∞–ø—É—Å—Ç–∏

```bash
node testSoapServer
```

—á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–π soap —Å–µ—Ä–≤–µ—Ä –≤ –≤–∏–¥–µ:

```
–ó–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–µ–Ω: –∏ —Ç. –¥.
```

---

## üß™ –û—Ç–ª–∞–¥–∫–∞

- –û—Ç–∫—Ä–æ–π [http://127.0.0.1:4040](http://127.0.0.1:4040) ‚Äî —ç—Ç–æ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ngrok.
- –¢–∞–º –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ.

---

## üßº –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Å—Ç–µ–∫

- Node.js + Express
- ngrok (–¥–ª—è –ø—Ä–æ–±—Ä–æ—Å–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
- ChirpStack (HTTP-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ webhook)

---

## üìé –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
node httpChirp.js

# –ü—Ä–æ–±—Ä–æ—Å —á–µ—Ä–µ–∑ ngrok
ngrok http 3000

# –ü—Ä–∏–Ω—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ soap —Å–µ—Ä–≤–µ—Ä–µ
node testSoapServer
```

---

## üìÇ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

- `init_db.js` ‚Äî —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ë–î –Ω–∞ SQLite. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è **–æ–¥–∏–Ω —Ä–∞–∑** –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º `server.js`. –°–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª –±–∞–∑—ã –∏ –Ω—É–∂–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã.
- `view_data.js` ‚Äî —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è **–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ë–î**. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏.
- `server.js` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞: **–ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å ChirpStack**, **—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î**, **–æ—Ç–¥–∞–µ—Ç –∏—Ö –ø–æ API**. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ **—á–µ—Ä–µ–∑ PM2** –∏–ª–∏ `systemd` –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ.

> üì° –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `server.js` **–±–µ–∑ ngrok**, –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –∏–º–µ–µ—Ç –≤–Ω–µ—à–Ω–∏–π IP –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–æ–º–µ–Ω. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ—Å—Ç–æ —É–∫–∞–∂–∏ –ø—Ä—è–º–æ–π URL –≤–∏–¥–∞:

```
http://your-server-domain.com/webhook
```

–≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö HTTP-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ ChirpStack. –ì–ª–∞–≤–Ω–æ–µ ‚Äî —É–±–µ–¥–∏—Å—å, —á—Ç–æ –ø–æ—Ä—Ç –æ—Ç–∫—Ä—ã—Ç, –∏ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ.